Этот код реализует блочный шифр ГОСТ 28147-89, также известный как "Магма". Это симметричный шифр, разработанный в Советском Союзе, который использует 256-битный ключ для шифрования 64-битных блоков данных.

**Описание алгоритма:**

ГОСТ 28147-89 основан на сети Фейстеля. Он выполняет 32 раунда преобразований над входным блоком данных. Каждый раунд состоит из следующих шагов:

1. **Разделение блока:** 64-битный блок данных разделяется на две 32-битные половины: левую (`left`) и правую (`right`).
2. **Функция F:** К правой половине применяется функция `f`, которая включает в себя сложение по модулю 2<sup>32</sup> с раундовым ключом, подстановку с помощью S-блоков и циклический сдвиг влево на 11 бит.
3. **XOR:** Результат функции `f` складывается по модулю 2 с левой половиной.
4. **Обмен:** Левая и правая половины меняются местами.

**Описание функций:**

* **`new()`:**  Создает новый экземпляр структуры `GostCypher` с заданными S-блоками. В данном случае используются S-блоки, определенные Центральным банком Российской Федерации.
* **`f(right: u32, k_i: u32) -> u32`:** Реализует функцию `f` алгоритма ГОСТ 28147-89. Принимает правую половину блока данных (`right`) и раундовый ключ (`k_i`) в качестве входных данных. Выполняет сложение по модулю 2<sup>32</sup>, подстановку с помощью S-блоков и циклический сдвиг.
* **`s(right: u32) -> u32`:** Выполняет подстановку байтов правой половины блока данных с помощью S-блоков. Каждый байт заменяется на соответствующее значение из S-блока.
* **`encryption_round(input_left: u32, input_right: u32, round_key: u32) -> (u32, u32)`:** Выполняет один раунд шифрования. Принимает левую и правую половины блока данных и раундовый ключ в качестве входных данных. Возвращает новые значения левой и правой половин после раунда шифрования.
* **`decryption_round(input_left: u32, input_right: u32, round_key: u32) -> (u32, u32)`:** Выполняет один раунд расшифрования. Аналогичен `encryption_round`, но использует обратный порядок раундовых ключей.
* **`encrypt(block: u64, key: &[u32; 8]) -> u64`:** Шифрует 64-битный блок данных (`block`) с использованием заданного ключа (`key`). Выполняет 32 раунда шифрования.
* **`decrypt(block: u64, key: &[u32; 8]) -> u64`:** Расшифровывает 64-битный блок данных (`block`) с использованием заданного ключа (`key`). Выполняет 32 раунда расшифрования с обратным порядком раундовых ключей.

**Ключевые особенности:**

* **S-блоки:** S-блоки играют важную роль в безопасности шифра. Разные наборы S-блоков могут использоваться для создания различных вариантов шифра.
* **Раундовые ключи:** 256-битный ключ используется для генерации 32 раундовых ключей по 32 бита каждый.
* **Сеть Фейстеля:** Структура сети Фейстеля обеспечивает обратимость шифрования, что позволяет использовать один и тот же алгоритм для шифрования и расшифрования.

Этот код представляет собой компактную и эффективную реализацию алгоритма ГОСТ 28147-89. Он может быть использован для защиты конфиденциальных данных в различных приложениях.
